# Offense Segment

```{r, echo=FALSE}
knitr::opts_chunk$set(
  echo    = FALSE,
  warning = FALSE,
  error   = FALSE,
  message = FALSE
)
```

```{r,  results='hide'}
load("data/nibrs_offense_segment_segment_2019.rda")
offense <- nibrs_offense_segment_segment_2019
rm(nibrs_offense_segment_segment_2019)
gc()
```

This segment provides information about the offense that occurred, and each incident can have multiple offenses. This data tells you which offense occurred and for a subset of offenses it also provides a more detailed subcategory of offense, allowing a deeper dive into what exactly happened. For example, for animal abuse there are four subcategories of offenses: simple/gross neglect of an animal, intentional abuse or torture, animal sexual abuse (bestiality), and organized fighting of animals such as dog or cock fights. This segment also says what date the crime occurred on, where the crime occurred - in categories such as residence or sidewalk rather than exact coordinates in a city - whether the offender is suspected of using drugs, alcohol, or a computer, and which weapon was used. In cases where the weapon was a firearm it says whether that weapon was fully automatic or not. It also provides information on if the crime was a hate crime by including a variable on the bias motivation (if any) of the offender. This is based on evidence that the crime was motivated, at least in part, by the victim's group (e.g. race, sexuality, religion, etc.). There are 34 possible bias motivations and while hate crimes could potentially be motivated by bias against multiple groups, this data only allows for a single bias motivation.

## Important variables

### Crime category

```{r offenseCrimeCategories}

temp <- make_frequency_table(offense,
                             "ucr_offense_code",
                             c("Crime Category",
                               "\\# of Offenses",
                               "\\% of Offenses"))

knitr::kable(temp, 
             format = "markdown",
             digits = 2, 
             align = c("l", "r", "r"),
             booktabs = TRUE, 
             longtable = TRUE,
             escape = FALSE,
             caption = "The number and percent of crimes reported from all agencies in 2019, by crime category.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

\setstretch{1.15}
### Offense subtype

```{r offenseCrimeSubcategories}

temp <- make_frequency_table(offense,
                             "type_criminal_activity_1",
                             c("Crime Subcategory",
                               "\\# of Offenses",
                               "\\% of Offenses"))
knitr::kable(temp, 
             format = "markdown",
             digits = 2, 
             align = c("l", "r", "r"),
             booktabs = TRUE, 
             longtable = TRUE,
             escape = FALSE,
             caption = "The number and percent of crime subtypes. This breakdown is only available for a subset of offenses.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

\setstretch{1.15}
* Aggravated Assault
* Animal Cruelty
* Counterfeiting/Forgery
* Drug Equipment Violations
* Drug/Narcotic Violations
* Fondling (Incident Liberties/Child Molest)
* Gambling Equipment Violations
* Intimidation
* Kidnapping/Abduction
* Murder/Non-negligent Manslaughter
* Negligent Manslaughter
* Pornography/Obscene Material
* Rape
* Robbery
* Sexual Assault With An Object
* Simple Assault
* Sodomy
* Stolen Property Offenses (Receiving, Selling, Etc.)
* Weapon Law Violations

```{r offenseCrimeSubcategoriesAnimalAbuse}

temp <- make_frequency_table(offense[offense$ucr_offense_code %in% "animal cruelty", ],
                             "type_criminal_activity_1",
                             c("Crime Subcategory",
                               "\\# of Offenses",
                               "\\% of Offenses"))
knitr::kable(temp, 
             format = "markdown",
             digits = 2, 
             align = c("l", "r", "r"),
             booktabs = TRUE, 
             longtable = TRUE,
             escape = FALSE,
             caption = "The number and percent of crime subtypes for animal abuse.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

\setstretch{1.15}
### Drug, alcohol, or computer use

```{r offenseDrugAlcoholComputer, fig.cap = "The distribution of drug, alcohol, or computer use for all offenses in 2019."}
offense %>%
  mutate(offender_suspected_of_using_1 = capitalize_words(offender_suspected_of_using_1)) %>%
crimeutils::make_barplots("offender_suspected_of_using_1", count = FALSE, ylab = "% of Offenses") +
  ggplot2::scale_y_continuous(labels = scales::percent)
```

```{r offenseDrugAlcoholComputerAny, fig.cap = "The distribution of drug, alcohol, or computer use for offenses where there was usage of one of these items. For easier viewing of how this variable is distributed, this figure excludes all offenses where there was no drug, alcohol, or computer use or the variable was NA."}
offense %>%
  filter(offender_suspected_of_using_1 != "not applicable") %>%
  mutate(offender_suspected_of_using_1 = capitalize_words(offender_suspected_of_using_1)) %>%
crimeutils::make_barplots("offender_suspected_of_using_1", count = FALSE, ylab = "% of Offenses") +
  ggplot2::scale_y_continuous(labels = scales::percent)
```

### Crime location

```{r offenseLocation}

temp <- make_frequency_table(offense,
                             "location_type",
                             c("Crime Location",
                               "\\# of Offenses",
                               "\\% of Offenses"))
knitr::kable(temp, 
             format = "markdown",
             digits = 2, 
             align = c("l", "r", "r"),
             booktabs = TRUE, 
             longtable = TRUE,
             escape = FALSE,
             caption = "The location of crimes for all offenses reported in 2019.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

\setstretch{1.15}
### Weapons

```{r offenseWeapon}

temp <- make_frequency_table(offense,
                             "type_weapon_force_involved_1",
                             c("Weapon Used",
                               "\\# of Offenses",
                               "\\% of Offenses"))
knitr::kable(temp, 
             format = "markdown",
             digits = 2, 
             align = c("l", "r", "r"),
             booktabs = TRUE, 
             longtable = TRUE,
             escape = FALSE,
             caption = "The weapon used by an offender in the crime for all offenses reported in 2019. The use means that it was part of the crime though may not have been physically discharged. For example, pointing a gun at someone even without firing the gun is still using it.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

\setstretch{1.15}
* Aggravated Assault
* Extortion/Blackmail
* Fondling (Incident Liberties/Child Molest)
* Human Trafficking - Commercial Sex Acts
* Human Trafficking - Involuntary Servitude
* Justifiable Homicide
* Kidnapping/Abduction
* Murder/Nonnegligent Manslaughter
* Negligent Manslaughter
* Rape
* Robbery
* Sexual Assault With An Object
* Simple Assault
* Sodomy
* Weapon Law Violations

### Automatic weapons

This variable only tells you if the weapon is automatic 

```{r offenseAutomaticWeapon, fig.cap = "The percent of firearms used that were fully automatic, for all offenses in 2019."}
temp <- 
  offense %>%
  filter(type_weapon_force_involved_1 %in% c("firearm (type not stated)",
                                             "handgun ",
                                             "other firearm",
                                             "rifle",
                                             "shotgun"))
temp$automatic_binary <- 0
temp$automatic_binary[temp$automatic_weapon_indicator_1 %in% "automatic weapon"] <- 1

temp <- 
  temp %>%
  group_by(type_weapon_force_involved_1) %>%
  summarize(automatic_weapon = mean(automatic_binary)) %>%
  mutate(type_weapon_force_involved_1 = capitalize_words(type_weapon_force_involved_1)) %>%
  arrange(desc(automatic_weapon))
temp$type_weapon_force_involved_1 <- factor(temp$type_weapon_force_involved_1, 
                                            levels = rev(temp$type_weapon_force_involved_1))


ggplot(temp, aes(x = type_weapon_force_involved_1, y = automatic_weapon)) +
  geom_col() +
  coord_flip() + 
  ggplot2::scale_y_continuous(labels = scales::percent) + 
  xlab("Weapon") +
  ylab("% Automatic Weapon") + 
  theme_crim()

```

### Hate crime indicator (bias motivation)

```{r offenseBiasMotivation}

temp <- make_frequency_table(offense,
                             "bias_motivation",
                             c("Bias Motivation",
                               "\\# of Offenses",
                               "\\% of Offenses"))
knitr::kable(temp, 
             format = "markdown",
             digits = 2, 
             align = c("l", "r", "r"),
             booktabs = TRUE, 
             longtable = TRUE,
             escape = FALSE,
             caption = "The bias motivation (i.e. if hate crime or not and what type of hate crime) for all offenses reported in 2019.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

\setstretch{1.15}

```{r offenseBiasMotivationBiases}

temp <- make_frequency_table(offense[!offense$bias_motivation %in% c("no bias motivation",
                                                                     "unknown bias motivation"),],
                             "bias_motivation",
                             c("Bias Motivation",
                               "\\# of Offenses",
                               "\\% of Offenses"))
knitr::kable(temp, 
             format = "markdown",
             digits = 2, 
             align = c("l", "r", "r"),
             booktabs = TRUE, 
             longtable = TRUE,
             escape = FALSE,
             caption = "The bias motivation (i.e. if hate crime or not and what type of hate crime) for all offenses reported in 2019 that were classifed as hate crimes. For easier viewing of how hate crimes are broken down, this excludes all offenses where there was no bias motivation.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

\setstretch{1.15}